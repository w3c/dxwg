<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Content Negotiation by Profile</title>
  <link rel="stylesheet" type="text/css" href="extra.css">
</head>
<body class="h-entry" id="respecDocument">
  <section id="abstract">
    <h2>Abstract</h2>
    <p>
      This document describes how Internet clients may negotiate for content provided by servers according to
      <em>profiles</em>. This is distinct from negotiating by Media Type or Language: a <em>profile</em> may
      specify the content of information returned, which may be a subset of the information the responding server has about the requested resource, and may be structured in a specific way to meet interoperability requirements of a community of practice.
    </p>
  </section>
  <section id="sotd">
    <!-- The "Status of This Document" section is generated by config.js -->
    <section id="FamilyOfDocs">
      <h3>Overview of DXWG documents on profiles</h3>
      <p>
        This document is one from set of documents on profiles, edited by the W3C Dataset Exchange Working Group (DXWG)
        and the Internet Engineering Taskforce (IETF). The documents are:
      </p>
      <ul>
        <li>[[PROF]] - the <em>Profiles Vocabulary</em>: an RDF vocabulary that describes profiles and related resources</li>
        <li><strong>[PROF-CONNEG] this document, specific guidance on how to negotiate for Internet resource content using profiles</strong></li>
        <li>[[PROF-IETF]] - <em>Indicating and Negotiating Profiles in HTTP</em>: an <a href="http://www.ietf.org">IETF</a> <a href="http://www.ietf.org/standards/ids/">Internet-Draft</a> defining HTTP Headers for HTTP content negotiation by profile</li>
        <li>The DXWG also plans to provide [[PROF-GUIDANCE]] - <em>Profile Guidance</em>: general recommendations and guidance on profiling.</li>
      </ul>
    </section>
  </section>
  <section id="introduction" class="informative">
    <h2>Introduction</h2>
    <p>
      Content delivered by dereferencing Internet identifiers can be negotiated for in different
      ways. When using the HTTP protocol [[RFC7230]], a client may set one or more request headers:
    </p>
    <ul>
      <li>an <code>Accept</code> header specifying preferred Media Types which the server may or may not supply</li>
      <li>an <code>Accept-Encoding</code> header to request that a specific content encoding system be used</li>
      <li>an <code>Accept-Language</code> header to indicate a preferred language</li>
    </ul>
    <p>
      However, clients have not had a
      defined way to negotiate for content based on its adherence to an information model - a standard, a <a>specification</a> or
      a <a>profile</a>. This document describes how such functionality can be delivered.
    </p>
    <p>
      When online information about a resource adheres to one or more profiles, methods described here allow
      clients to request lists of those profiles and request content according to one or more of them, in order of preference.
    </p>
    <p>
      For example, a catalog may offer choices of representations of a dataset's description that conform to different information models, perhaps [[VOID]],
      [[VOCAB-DATA-CUBE]] and [[VOCAB-DCAT]]. Furthermore, the [[VOCAB-DCAT]] representation might conform to the
      [[DCAT-AP]] profile, the [[GeoDCAT-AP]] profile and perhaps also an organisation-specific profile "MyOrgDCATProfile".
      These "narrower" profiles constrains various elements of the dataset's description above and beyond the "broader", more general, specification or profile that they profile.
      A request for information about this dataset description's possible representations may
      ask for the list of profiles to which conformant representations of it are available, or may ask specifically for a representation conforming to one profile, for example
      [[GeoDCAT-AP]]. When no profile or an unsupported profile is requested, a server returns default content,
      that is, content conforming to the default profile supported by the server.
    </p>
    <p>
      When selecting a content negotiation mechanism, an Internet client may use the HTTP protocol, but it may also use
      other methods for providing instructions to a server. One of potentially many mechanisms is URI Query String
      Arguments (<abbr title="Query String Arguments">QSAs</abbr>). QSAs are
      useful for humans and machines for situations where negotiation via HTTP is not practical, such
      as when manually entering requests into web browsers. This specification provides an abstract model
      of content negotiation by profile and presents guidance on the use of two specific methods, HTTP &amp; QSA, that both conform to the abstract model meaning they are.
    </p>
    <p>
      While this specification only describes HTTP and QSA methods for content negotiation by profile, it is expected
      that implementers will want to implement functionally equivalent methods for other environments, some of which may
      not yet be realized; future environments. Implementers may add additional functions/features to their implementations for other environments as long as they ensure their implementation conforms to this specification's abstract model, as the HTTP and QSA methods do.
    </p>
    <p>
      While this specification only describes HTTP and QSA methods for content negotiation by profile, it is expected
      that implementers will want to implement functionally equivalent methods for other environments, some of which may
      not yet be realized; future environments.
    </p>
    <!--
    <p>
      Guidance for the creation of <a>profile</a>s is provided in the [[PROF-GUIDANCE]] document created
      by the Dataset Exchange Working Group (DXWG).
    </p>
    -->
    <p>
      Describing how resources' representations conform to profiles and how profiles and specifications relate to one
      another is not part of this specification. Parts of those questions are addressed by the Profiles Vocabulary
      [[PROF]], also produced by the DXWG.
    </p>
  </section>
  <section id="conformance">
    <p>
      For the purpose of compliance, the normative sections of this document are
      <a href="#definitions">Section 3</a>,
      <a href="#abstractmodel">Section 6</a>,
      <a href="#functional-profiles">Section 7</a> and
      <a href="#testsuites">Section 8</a>.
    </p>
    <p class="note">Specifications and Profiles to which the content of resource representations may conform embody their own notions of conformance, which are out of scope for this specification.</p>
    <section id="conformance-profiles">
      <h3>Profiles for Conformance</h3>
      <p>
        This specification includes several functional <a>profiles</a> of it that may be conformed to by systems claiming to implement a form of this specification.
        These profiles, given in the table below, are identified by URIs and conformance to them by Internet resources should be indicated as per this document (use of
        <code>Content-Profile</code> HTTP header).
      </p>
      <div class="note" title="Different forms of specification and profile">
        The <a>profiles</a> identified and described in this section are of a <em>functional</em> <a>specification</a>
        since Content Negotiation by Profile describes how systems should behave and it follows that these profiles
        are <em>functional</em> profiles. This specification offers test suites (see <a href="#testsuites"></a>) for
        assessing the conformance of systems to this functional specification and these functional profiles but does not
        address the conformance of resources to the data specifications and data profiles that Content Negotiation by
        Profile supplies methods to negotiate about. Such testing is left to the implementers of those data
        specifications and data profiles that resources are indicated to conform to.
      </div>
      <p>
        The namespace prefix for the functional profiles used in <a href="#fig-table-profiles"></a>, the table below, is:
      </p>
      <ul>
        <li><code>cnpr</code> &rarr; <code>http://www.w3.org/ns/dx/conneg/profile/</code></li>
      </ul>
      <figure id="fig-table-profiles">
        <table>
          <thead>
          <tr>
            <th>URI</th>
            <th>Name</th>
            <th>Description</th>
            <th>Usage Note</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td><code><a href="http://www.w3.org/ns/dx/conneg/profile/http">cnpr:http</a></code></td>
            <td>HTTP Headers Functional Profile</td>
            <td>For conformance with the functional profile presented in <a href="#http"></a>.</td>
            <td>To be used if a resource conforms to the HTTP Headers Functional Profile</td>
          </tr>
          <tr>
            <td><code><span style="white-space: nowrap"><a href="http://www.w3.org/ns/dx/conneg/profile/qsa">cnpr:qsa</a></span></code></td>
            <td>QSA Functional Profile</td>
            <td>For conformance with the functional profile presented in <a href="#qsa"></a>.</td>
            <td>
              To be used if a resource conforms to the QSA Functional Profile using the Query String Arguments <code>_profile</code> and <code>_mediatype</code> as per the recommendations
              in <a href="#qsa"></a>.
            </td>
          </tr>
          <tr>
            <td><code><span style="white-space: nowrap"><a href="http://www.w3.org/ns/dx/conneg/profile/qsa-alt">cnpr:qsa-alt</a></span></code></td>
            <td>QSA Alternate Keywords Functional Profile</td>
            <td>For conformance with the functional profile presented in <a href="#qsa"></a>.</td>
            <td>
              To be used if a resource conforms to the QSA Functional Profile but uses alternate keywords for the Query String Arguments <code>_profile</code> and
              <code>_mediatype</code>, as allowed by the recommendations in <a href="#qsa"></a>.
            </td>
          </tr>
          <tr>
            <td><code><span style="white-space: nowrap"><a href="http://www.w3.org/ns/dx/conneg/profile/rrd">cp:rrd</a></span></code></td>
            <td>Resource Representation Description</td>
            <td>For conformance with <a href="#getresourcebyprofile"></a>.</td>
            <td>
              To be used if a resource representation is able to indicate which profile(s) it conforms to, in its appropriate functional profile, as per the abstract specification in
              <a href="#getresourcebyprofile"></a>.
            </td>
          </tr>
          </tbody>
        </table>
        <figcaption>
          Profiles of this <em>Content Negotiation by Profile</em> specification to be used by resources and systems to indicate conformance to one or more forms
          of it.
        </figcaption>
      </figure>
      <p>
        If a system wishes to show conformance to this specification, conformance to at least one of the profiles listed in <a href="#fig-table-profiles"></a> MUST be indicated.
      </p>
      <p>
        The namespace used for the above profiles, <code>http://www.w3.org/ns/dx/conneg/profile/</code>, is part of the Dataset Exchange Working Group's reserved W3C namespace,
        <code>http://www.w3.org/ns/dx/</code>, which is provisioned for all namespace requirements to do with issues addressed by that Working Group. The <code>/profile/</code> path segment
        indicates a register of profile objects which currently contains just the 4 instances above from <a href="#fig-table-profiles"></a>.
      </p>
    </section>
  </section>
  <section id="definitions">
    <h2>Definitions</h2>
    <dl>
      <dt><dfn data-lt="specification">specification</dfn></dt>
      <dd>
        <p>
          A basis for comparison; a reference point against which other things can be evaluated.
        </p>
        <p>
          <em>Source: DCMI Metadata Terms [[DCTERMS]]'s definition for a <code><a href="http://www.dublincore.org/specifications/dublin-core/dcmi-terms/#terms-Standard">Standard</a></code>.</em>
        </p>
      </dd>
      <dt><dfn data-lt="data specification">data specification</dfn></dt>
      <dd>
        <p>
          A <a>specification</a>, with human- and/or machine-processable representations, that defines the content and structure of data used in a given context.
        </p>
        <p><em>Source: deliberations of the DXWG.</em></p>
      </dd>
      <dt><dfn data-lt="profile">profile</dfn></dt>
      <dd>
        <p>
          A <a>specification</a> that constrains, extends, combines, or provides guidance or explanation about the usage of other specifications.
        </p>
        <p>
          This definition includes what are sometimes called "application profiles", "metadata application
          profiles", "data profiles" (when applied to <a>data specifications</a>) or "metadata profiles".
          In this document, these are all referred to as just "profiles" and no distinction, in wording, is made
          between profiles of different types of specification: data, functional etc.
        </p>
        <p><em>Source: deliberations of the DXWG.</em></p>
      </dd>
      <dt><dfn>client</dfn></dt>
      <dd>
        A program that establishes a connection to a <a>server</a> for the purpose of sending one or more HTTP requests. [[RFC7230]]
      </dd>
      <dt><dfn>server</dfn></dt>
      <dd>
        A program that accepts connections in order to service HTTP <a>requests</a> by sending HTTP <a>responses</a>. [[RFC7230]]
      </dd>
      <dt><dfn>resource</dfn></dt>
      <dd>
        The entity that is identified by a URI. Familiar examples include an electronic
        document, an image, a source of information with a consistent purpose. [[RFC3986]]
      </dd>
      <dt><dfn>representation</dfn></dt>
      <dd>
        <p>
          An abstraction of the current or desired state of a thing in HTTP communications. [[RFC7230]]
        </p>
        <p>
          In this specification, <em>representations</em> are of <a>resources</a>.
        </p>
      </dd>
      <dt><dfn>metadata</dfn></dt>
      <dd>Information that is supplied about a resource. [[RFC3986]]</dd>
      <dt><dfn>request</dfn></dt>
      <dd>A message sent over the Internet, from a <a>client</a> to a <a>server</a>, for a information about a <a>resource</a>. [[RFC7230]]</dd>
      <dt><dfn>response</dfn></dt>
      <dd>A message sent over the Internet, from a <a>server</a> to a <a>client</a> answering a <a>request</a> for information about a <a>resource</a>. [[RFC7230]]</dd>
      <dt><dfn>token</dfn></dt>
      <dd>A short name identifying something. In the context of this document, tokens are sometimes used to identify <a>profiles</a>.</dd>
    </dl>
  </section>
  <section id="motivation" class="informative">
    <h2>Motivation</h2>
    <p>
      In many cases, there are several ways to describe a resource within the scope of a single Media Type.
      For instance, XML documents, while conforming to the <code>text/xml</code> Media Type, may adhere to one of
      several DTDs or XML Schemas. RDF documents, with a choice of Media Type serializations such as
      <code>text/turtle</code>, <code>application/rdf+xml</code> and others, have a large number of vocabularies
      (classes and properties) available to use for their content's information model. When a client initiates a request
      for an Internet resource, such as an HTTP GET to retrieve a resource's representation, the client and server must have a standardized way to exchange information on how the transmitted resource
      will be structured according to DTDs, XML Schema, vocabularies or other standards, specifications or
      <a>profiles</a>. When using non-HTTP content negotiation, various methods such as URIs with Query String
      Arguments have been implemented previously,
      for instance the
      <abbr title="Open Archives Initiative - Protocol for Metadata Harvesting">OAI-PMH</abbr> [[OAI-PMH]] and
      <abbr title="Open Geospatial Consortium">OGC</abbr>'s
      <abbr title="Catalogue Service for the Web">CSW</abbr> [[CSW]] protocols.
    </p>
    <p>
      This document describes an abstract, functions-based, specification for content negotiation by profile and gives both an
      HTTP functional profile and two Query String Argument-based functional profiles for the specification's implementation in different environments. The query string
	   approaches provide both a "fall back" (second, non-HTTP implementation of the abstract specification), as required by the
      <a href="https://www.w3.org/2017/dxwg/charter">Dataset Exchange Working Group's Charter</a> (Section 2.3) and also demonstrations functional profiles of the abstract specification that potential functional profile implementers may take as guidance for their implementations.
    </p>
    <p>
      Other query string or REST-based functional profiles and indeed radically different environment's implementation of this abstract specification
      are considered possible but are not specified here. In general, existing APIs that support the listing of alternative
      profiles for resource representations and retrieval of resource representations to profiles may support and demonstrate conformance to this specification too by implementing its required functionality, as the given functional profiles do.
    </p>
  </section>
  <section id="relatedwork" class="informative">
    <h2>Related Work</h2>
    <p>
      The standardization of the content-negotiation HTTP headers is the purview of the IETF. A first proposal
      for an <a href="https://profilenegotiation.github.io/I-D-Profile-Negotiation/I-D-Profile-Negotiation">Internet Draft
      for Indicating and Negotiating Profiles in HTTP</a> [[PROF-IETF]] is available but has not yet been submitted to the IETF. The
      current version of the IETF draft (-00) is expected to be completely re-written in parallel work with this document and should
      not be seen as anything but work-in-progress until this paragraph is removed from this document.
    </p>
    <section id="related-http">
      <h3>Existing standards for transporting profile information in HTTP headers</h3>
      <h4>Using Accept/Content Type together with the profile parameter</h4>
      <p>The HTTP Accept and Content-Type header fields [[RFC7231]]
        allow a client to specify acceptable Media Types (<code>Accept</code>)
        and a server to indicate the Media Type of the response's body (<code>Content-Type</code>).
        A Media Type registration can also specify an optional list of Media Type parameters.
        Some Media Type registrations (e. g. <code>application/ld+json</code>)
        have specified the use of a Media Type parameter "profile"
        that could be used to signal the profile that the body of the response conforms to.</p>
      <pre id="eg-profile-and-accept" class="example nohighlight" aria-busy="false" aria-live="polite"
           title="Using the profile parameter in an Accept header together with the Accept-Profile header">
GET /resource/a HTTP/1.1
Accept: text/turtle;q=0.9;profile="urn:example:profile-1", \
        text/turtle;q=0.7;profile="urn:example:profile-2"

--

HTTP/1.1 200 OK
Content-Type: text/turtle;profile="urn:example:profile-2"
      </pre>
      <p>During 2018, DXWG members had a longer discussion with the <a href="https://www.w3.org/2018/json-ld-wg/">JSON-LD WG</a> at the annual forum TPAC in Lyon, France
    and it was concluded that the "profile” parameter in the <code>Accept</code> and <code>Content-Type</code>
    headers should be seen to convey profiles that are specific to the Media Type,
    such as JSON-LD's "expanded" (<code>http://www.w3.org/ns/json-ld#expanded</code>) or
    "flattened" (<code>http://www.w3.org/ns/json-ld#flattened</code>).
    In order to signal the use of Media Type-independent profiles,
    the http header fields <code>Accept-Profile</code> and <code>Content-Profile</code> are to be used.</p>
      <h4>Using a Link header with rel="profile" (RFC 6906)</h4>
      <p>The HTTP Link header field [[RFC8288]] relates a web resource (Link Context)
    to a target resource (Link Target)
    by specifying the relation between the two resources.
    One of the relation types is "profile", as defined in [[RFC6906]].
        [[RFC6906]] <a data-cite="RFC6906#section-3">defines a profile</a> as
        "additional semantics that can be used to process a resource representation […]
        that do not alter the basic Media Type semantics"
        and specifically states that
        "creators and users of profiles MAY define and manage them in a way
        that allows them to be used across Media Types".
        So the "profile" relation seems like a suitable way
        to communicate information about acceptable profiles (requests) and content (responses).</p>
      <pre id="eg-link-header-with-profile" class="example nohighlight" aria-busy="false" aria-live="polite"
           title="Using a Link header with a profile parameter">
HEAD /resource/a HTTP/1.1
Accept: text/turtle;q=0.9,application/rdf+xml;q=0.5
Link: &lt;http://example.com/profile/x&gt;; rel="profile"

--

HTTP/1.1 200 OK
Content-Type: text/turtle
Link: &lt;http://example.com/profile/x&gt;; rel="profile"
      </pre>
      <p>There is, however, no possibility to convey quality information (q-values) using the "profile" relation.</p>
      <h4>Using the Prefer/Preference-Applied header fields (RFC 7240)</h4>
      <p>The http <code>Prefer</code> and <code>Preference-Applied</code> header fields [[RFC7240]]
      can be used to convey information about profile preferences.
      A client could use the <code>Prefer</code> header to tell the server about
      its preference for a resource's representation conforming to a specific profile.
      If the server sends a <code>Preference-Applied</code> header field in the response,
      the client will know that the preference was honoured.</p>
      <pre id="eg-prefer-header-with-profile" class="example nohighlight" aria-busy="false" aria-live="polite"
           title="Using a Prefer header with a profile parameter">
GET /resource/a HTTP/1.1
Accept: text/turtle
Prefer: profile="urn:example:schema"

--

HTTP/1.1 200 OK
Content-Type: text/turtle
Preference-Applied: profile="urn:example:schema"
      </pre>
      <p>This approach has two disadvantages.
      The first is, as with the <code>Link</code> header,
      that there is no possibility to work with q-values.
      The second one is that the only way for a server to state
      that it ignored the preference indicated by the client
      is to omit sending a <code>Preference-Applied</code> header field.
      For the client, however, it is not clear
      if the <code>Preference-Applied</code> header is absent
      because the server did not honour the preference,
      or because the server did not understand
      the <code>Prefer</code> header.
      This could be solved by making it mandatory to send a
      <code>Link: rel=profile</code> header when answering a request
      with a <code>Prefer: profile=""</code> header in it.
      That solution requires that a client evaluates two different headers
      to find a response to its request for a specific profile,
      which would make client implementation more complicated.</p>
    </section>
	  <section id="related-ark">
		  <h3>Archival Resource Key (ARK)</h3>
		  <p>
        ARK (Archival Resource Key) [[ARK]] is an identifier scheme
        for the persistent identification of information objects.
        ARK identifiers can contain an optional qualifier
        "that extends the base ARK in order to create a kind of service entry point
        into the object named by the NAA [sc. Name Assigning Authority]".
        Through a qualifier, any NMA (Name Mapping Authority, a service provider offering ARK resolution)
        can supply access to variants of that object.
        The set of qualifiers is open and any ARK NAA or NMA can invent its own.
        The ARK specification lists versions, languages and formats as examples of qualifiers (§2.5)
        and a profile name could be used as a qualifier
        to refer to a representation of an information object conforming to that specific profile.
        For example, the URI <a href="https://api.istex.fr/ark:/67375/6GQ-MLC8GRWC-5/">https://api.istex.fr/ark:/67375/6GQ-MLC8GRWC-5/</a>
        lists XML encodings of metadata for the resource identified by the ARK <code>67375/6GQ-MLC8GRWC-5</code>,
        conforming to different XML vocabularies, including "MODS", the Library of Congress'
        <a href="https://www.loc.gov/standards/mods/">Metadata Object Description Schema</a>.
		  </p>
	  </section>
    <section id="related-altviews">
      <h3>Linked Data APIs</h3>
      <p>
        Several Linked Data API tools provide access to different representations of resources, identified by URI, using
        Query String Arguments (QSAs). Two examples are the
        <a href="http://epimorphics.github.io/elda/current/index.html">ELDA tool by Epimorphics</a>, an
        implementation of the <a href="https://github.com/UKGovLD/linked-data-api/blob/wiki/Specification.md">Linked
        Data API</a> specification created by the government of the United Kingdom, and <a href="https://pypi.org/project/pyLDAPI/">pyLDAPI</a>, a
        Linked Data API implementation by <a href="https://www.csiro.au/">CSIRO</a> in the Python programming language. Both of these tools allow for the
        listing of <em>views</em> and <em>formats</em> available for a resource by dereferencing a URL created by
        adding the <code>_view=alternates</code> <abbr title='Query String Argument'>QSA</abbr> to the resource URI. The
        <em>view</em> named <em>alternates</em> is a special view available for all resources that lists all other views.
      </p>
      <p>
        What these tools call a <em>view</em> is analogous to a <a>profile</a> and a <em>format</em> to an HTTP Media Type.
      </p>
      <p>
        These APIs provide for direct access to resource representations, conforming to a particular view, in a
        particular format, or a default view/format if either is unspecified or invalid. For example, using pyLDAPI, the
        available views and formats for representations of the address <a href="http://linked.data.gov.au/dataset/gnaf/address/GAACT714845933">GAACT714845933</a>
        can by seen by dereferencing <a href="http://linked.data.gov.au/dataset/gnaf/address/GAACT714845933?_view=alternates">http://linked.data.gov.au/dataset/gnaf/address/GAACT714845933<strong>?_view=alternates</strong></a>
        and the "ISO19160" <em>view</em> of that Address in the RDF Turtle
        <em>format</em>, listed by the Alternates View, is available at <a href="http://linked.data.gov.au/dataset/gnaf/address/GAACT714845933?_view=ISO19160&_format=text/turtle">http://linked.data.gov.au/dataset/gnaf/address/GAACT714845933<strong>?_view=ISO19160&amp;_format=text/turtle</strong></a>.
      </p>
    </section>
    <section id="related-oai-pmh">
      <h3>OAI-PMH</h3>
      <p>
        The Open Archives Initiative Protocol for Metadata Harvesting [[OAI-PMH]] "...provides an
        application-independent interoperability framework based on metadata harvesting.". In doing this, OAI-PMH
        specifies Query String Argument-based "Protocol Requests and Responses" that allow clients of
        <em>Data Providers</em> to: retrieve the metadata <em>formats</em> (analogous profiles, as described in this document) available from a repository
        (<code>ListMetadataFormats</code>); retrieve metadata for an identified record (<code>GetRecord</code>),
	according to an identified metadata profile (<code>metadataPrefix</code>); perform a number of other repository interrogation tasks; and to
        harvest collections of record's metadata, filtered by parameters such as modified date.
      </p>
      <p>
        OAI-PMH requires that representations of all resources in a repository are available according to the same set
        of profiles (what it calls <em>formats</em>). It is also entirely XML-based so that profiles, must
        all be presented in XML and the content of an XML representation of a resource is presented within an XML
        envelope that always identifies the record, the profile, the OAI-PMH method used, the request time and other
        common metadata.
      </p>
    </section>
    <section id="related-csw">
      <h3>Catalogue Service for the Web (CSW)</h3>
      <p>
        [[CSW]] is the OGC standard used world-wide by the geospatial community to implement a machine-actionable interface
	to catalog services, providing access to metadata about datasets, geospatial services ([[WMS]], [[WFS]], etc.),
	as well as other types of resources. Besides supporting common functions such as free-text and faceted search, CSW supports the retrieval of metadata according to a given metadata schema and format, indicated respectively by using <code>outputSchema</code> and <code>outputFormat</code> query parameters. Commonly supported metadata schemas are [[DC11]], and [[ISO-19115]], and the default format is XML. A given CSW instance's supported metadata schemas and formats are described in the service "capabilities" &ndash; a machine-readable description of the service interface &ndash; that is returned via a <code>GetCapabilities</code> request.
      </p>
      <p>
        Notably, CSW theoretically supports HTTP content negotiation for the metadata format, and the specification defines a conflict resolution mechanism for requests where this information is specified both via HTTP <code>Accept</code> headers and the <code>outputFormat</code> parameter (see Section 6.2 of the <a href="http://docs.opengeospatial.org/is/12-176r7/12-176r7.html">OGC CSW 3.0 specification - HTTP Protocol Binding</a>).
      </p>
    </section>
  </section>
  <section id="abstractmodel">
    <h2>Abstract Model</h2>
    <p>
      This section describes a conceptual &ndash; abstract &ndash; model for content negotiation by profile, independent of any
      implementation it within specific environments.
    </p>
    <p>
      Implementations of this abstract model for different environments are called <em>functional <a>profiles</a></em> and to be a valid functional profile they MUST implement these abstract model functions. How they do this will be
      environment-specific.
    </p>
    <section id="connegbackground">
      <h3>Content Negotiation Background</h3>
      <p>
        All content negotiation takes place between a <a>client</a> and a <a>server</a> over the Internet with the
        former requesting a representation of a <a>resource</a> or a <a>resource</a>'s <a>metadata</a> through a
        <a>request</a> and receiving it via a <a>response</a>. For any given pair of communicating machines, the
        the roles of <a>client</a> and <a>server</a> may be reversed as information is requested back and forth.
      </p>
      <p>
        An Internet <a>resource</a> may have many aspects over which a <a>client</a>/<a>server</a> pair of
        agents might negotiate for content. These aspects are to be treated independently so content negotiation for a
        resource involving negotiation by profile and any other aspects will not affect each other.
      </p>
      <!--
      <p>
        For this reason, other than a directive to maintain independence, no further discussion of
        negotiation by profile and the relations to other forms of negotiation are given. Specific functional profiles
        might require special handling of profile and other forms of negotiation.
      </p>
      -->
      <p>
        In this abstract model, we don't assume any specific details about <a>client</a>, <a>server</a>,
        <a>resource</a>, <em>metadata</em>, <a>request</a> or <a>response</a> other than those details already
        provided in those terms' definitions in <a href="#definitions"></a>.
      </p>
    </section>
    <section id="profileid">
      <h3>Profile Identification</h3>
      <p>
        A <a>client</a> <a>request</a>ing the representation of a <a>resource</a> conforming to a <a>profile</a>
        MUST identify the <a>resource</a> by a Uniform Resource Identifier (URI) [[RFC3986]] and MUST
        identify the <a>profile</a> either by a URI or a <a>token</a>.
      </p>
      <p>
        If a URI is used for profile identification, it SHOULD be an HTTP
        URI that dereferences to a description of the profile. Other kinds or URIs, e. g. URNs MAY also be used and these may no be capable of dereferencing.
        If a token is used, it MUST unambiguously identify the
        <a>profile</a> within a <a>request</a>/<a>response</a> pair of messages.
        The server MUST declare the context within which the token may be mapped to a URI.
      </p>
    </section>
    <section id="requestsandresonses">
      <h3>Requests and Responses</h3>
      <p>
        There are two main types of <a>request</a> that a <a>client</a> might make of a <a>server</a> regarding
        content negotiation by profile. A <a>client</a> wishing to negotiate for content via a profile adhering to this
        specification MUST be able to implement these two request types.</p>
      <ol>
        <li>
          <strong>list profiles</strong><br />
          a <a>client</a> requests the list of URIs of <a>profile</a>s for which a <a>server</a> is able to deliver
          conformant <a>resource</a> <a>representations</a>
        </li>
        <li>
          <strong>get resource by profile</strong>
          <br />a <a>client</a> requests a <a>representation</a> of the requested <a>resource</a> represented conforming
          to a particular <a>profile</a>
        </li>
      </ol>
      <p>
        A <a>server</a> adhering to this specification MUST respond to each request with the following
        <a>response</a>s.
      </p>
      <ol>
        <li>
          <strong>list profiles</strong><br />
          a <a>server</a> responds to a <a>client</a> with the list of URIs of the <a>profiles</a> for which it is able
          to deliver conformant <a>resource</a> <a>representations</a>
        </li>
        <li>
          <strong>get resource by profile</strong><br />
          a <a>server</a> responds with either a specific <a>profile</a> for a <a>resource</a> conforming to a
          requested <a>profile</a> identified by the <a>client</a> or it responds with a default <a>profile</a>
        </li>
      </ol>
      <p>More detailed descriptions of these requests and their responses are given next.</p>
      <section id="listprofiles">
        <h4>list profiles</h4>
        <p>
          A <a>client</a> wishes to know for which <a>profile</a>s a <a>server</a> is able to deliver conformant
          representations of a <a>resource</a>. The list of profiles may be known either before a <a>request</a> for a
          particular <a>resource</a> representation is made or it may only be known after an initial <a>request</a> is
          made.
        </p>
        <p>
          The <strong>list profiles</strong> <a>request</a> MUST be either an independent request or part of another
          functional profile's request.
        </p>
        <p>
          The <strong>list profiles</strong> <a>request</a> MAY result in a <a>response</a> in one of a
          number of formats, provided that the <a>profile</a>s representations of resources
          conform to are unambiguously identified either by either a URI or a <a>token</a>. If the latter, it MUST be
          mappable to a URI within one particular client/server message pair.
        </p>
        <p>
          A <a>server</a> MUST NOT list <a>profile</a>s that <a>resource</a> representations conform to if
          it is unable to deliver those representations when presented with a <strong>get resource by profile</strong>
          <a>request</a>.
        </p>
        <p>
          <a href="#eg-list-simple"></a> shows a request/response pair of messages, conforming to the QSA Functional
          Profile, where the request is a <em>list profiles</em> request for a particular resource.
        </p>
        <pre id="eg-list-simple"
             class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Simple list profiles request & response messages (QSA Functional Profile)">
# A request for all the profiles to which representations of resource a conform
GET /resource/a<strong>?_profile=all</strong> HTTP/1.1

---

# The server returns a list of profiles both in its HTTP response header and also
# in the response body (HTML). Note that the action of returning the response message
# conforms to the QSA Functional Profile and this is indicated with the Content-Profile
# header.
HTTP/1.1 200 OK
Content-Type: application/json
Content-Profile: &lt;http://www.w3.org/ns/dx/conneg/profile/qsa>
# This Link header indicates representations ar available that conform to Profile X
# &amp; Y and that the Profile X-conformant representations are available in HTML
# &amp; XML Media Types.
Link:
  &lt;http://example.org/resource/a?_profile=profile-x&amp;_mediatype=text/html>;
          rel="self"; type="text/html";
          profile="http://otherexample.org/profile/x",
  &lt;http://example.org/resource/a?_profile=profile-x&amp;_mediatype=text/xml>;
          rel="alternate";
          type="text/xml";
          profile="http://otherexample.org/profile/x",
  &lt;http://example.org/resource/a?_profile=profile-y&amp;_mediatype=text/xml>;
          rel="alternate";
          type="text/xml";
          profile="http://otherexample.org/profile/y"

&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset="UTF-8">
    &lt;title>Profiles for Resource A&lt;/title>
  &lt;/head>
  &lt;body>
    &lt;h1>Profiles available for Resource X&lt;/h1>
    &lt;ul>
      &lt;li>&lt;a href="?_profile=profile-x&_mediatype=text/html">X, in HTML&lt;/a>&lt;/li>
      &lt;li>&lt;a href="?_profile=profile-x&_mediatype=text/xml">X, in XML&lt;/a>&lt;/li>
      &lt;li>&lt;a href="?_profile=profile-y&_mediatype=text/xml">Y, in XML&lt;/a>&lt;/li>
    &lt;/ul>
  &lt;/body>
&lt;/html>
        </pre>
      </section>
      <section id="getresourcebyprofile">
        <h4>get resource by profile</h4>
        <p>
          The most basic <a>request</a> of content negotiation by profile is for a <a>client</a> to <a>request</a>
          a representation of a <a>resource</a> that is claimed to conform to a <a>profile</a>.
        </p>
        <p>
          A <a>client</a> executing a <strong>get resource by profile</strong> <a>request</a> MUST
          identify the <a>profile</a> with either a URI or a token mapping unambiguously within a session to a URI.
        </p>
        <p>
          A <a>client</a> executing a <strong>get resource by profile</strong> MAY <a>request</a> a
          <a>resource</a> representation conforming to one of any number of <a>profile</a>s with its preference
          expressed in a functional profile-specific ordering.
        </p>
        <p>
          The server SHOULD attempt to reply with a profile that best matches the client request. The order of
          preference a server MUST follow to determine a best matching profile is: an exact match, followed the
          next most specific profile that the resource representation conforms to. Note that resource representations
          might conform to more general specifications/other profiles via a hierarchy (i.e. transitively).
        </p>
        <p>
          If a server redirects to another resource it MUST indicate the selected choice of profile from the list
          requested by the client and SHOULD indicate a specific narrower profile expected to be returned (if known)
          in the redirection request (303 response).
        </p>
        <div class="note" title="Redirection to another resource">
          Since <em>get resource by profile</em> requests are for <a>representations</a> of a <a>resource</a> and resources
          for which there are profile-conformant representations may not be information resources, it is important to
          note that a server's response may take the form of a redirect to another resource. This is as per the
          <a href="https://lists.w3.org/Archives/Public/www-tag/2005Jun/0039.html">W3C's recommendations to handle the
            so-called 'httpRange-14' issue</a>. An example of a redirecting response is given in <a href="#eg-range14"></a>.
        </div>
        <p>
          A simple request/response message pair with <code>Accept-Profile</code> and <code>Content-Profile</code>
          headers included, according to the <a href="#http">HTTP Headers Functional Profile</a>, is shown in
          <a href="#eg-simple"></a> and an example with a redirect is shown in <a href="#eg-range14"></a>.
          <a href="#eg-narrower-profile-response"></a> shows an HTTP Headers Functional Profile message pair indicating a
          narrower profile response than the requested profile.
        </p>
        <pre id="eg-simple"
             class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Simple get resource by profile request & response (HTTP Headers Functional Profile)">
# A request for resource a according to Profile x is made
GET /resource/a HTTP/1.1
Accept-Profile: http://example.org/profile/x

---

# The server returns a representation of Resource a conforming with Profile x
HTTP/1.1 200 OK
Content-Profile: http://example.org/profile/x

[response body]
        </pre>
        <pre id="eg-range14"
             class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Get resource by profile request & response (HTTP Headers Functional Profile) with 303 redirect">
# A request for a non-information resource a according to Profile x is made
GET /resource/a HTTP/1.1
Accept-Profile: http://example.org/profile/x

---

# The server returns a 303 Redirect to another URI identifying an information
# resource that then returns the requested resource representation. The redirecting
# server indicates the profile to which the redirected to resource representation
# conforms
HTTP/1.1 303 See Other
Location: http://example.org/info-resource/b
Content-Profile: http://example.org/profile/x

---

# The client now requests the indicated information resource. Note that the
# Accept-Profile header is no longer needed since the original response has
# catered for that in the redirect response
GET /info-resource/b HTTP/1.1

---

# The final server response with the information resource. Note that this
# response does not include the profile-indicating Content-Profile header
HTTP/1.1 200 OK

[response body]
        </pre>
        <pre id="eg-narrower-profile-response" class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Get resource by profile, narrower profile response (HTTP Headers Functional Profile)">
# A request for Resource A whose representation conforms
# to Profile X is made

GET /resource/a HTTP/1.1
Accept-Profile: http://example.org/profile/x
[more request headers]

---

# The server is able to respond with a representation of
# Resource a according to Profile Y which it knows is a
# profile of Profile X

# The server responds with the list of profiles that it knows
# the resource representations conforms to ensuring that the
# requested profile, Profile X, is lists. Here Profile Y and
# a further profile irrelevant for the client, Profile Z, are
# indicated.

HTTP/1.1 200 OK
[other response headers]
Content-Profile: http://example.org/profile/x, \
                 http://example.org/profile/y, \
                 http://example.org/profile/z
[more response headers]

[content conforming to to Profile X, Y & Z]
        </pre>
        <p>
          When a resource is returned that conforms to two or more profiles not within a profile hierarchy
          (i.e. none of the multiple profiles the resource conforms to is a profiles of another), the server MUST
          indicate all profiles individually within the <code>Content-Profile</code> header as such:
        </p>
        <p>
          <code>Content-Profile: &lt;PROFILE_1>, &lt;PROFILE_2></code>
        </p>
        <p>
          For example, a response from a server that conforms to both [[?GeoDCAT-AP]] and also [[?STATDCAT-AP]], given
          that neither profiles the other and thus no single indication of conformance will suffice for both, (note they
          both do profile [[?DCAT-AP]], see the <a href="https://www.w3.org/TR/dx-prof/#eg-hierarchy">DCAT-AP Hierarchy
          example in [[PROF]]</a>), using profile URIs for [[?GeoDCAT-AP]] and [[?STATDCAT-AP]] could be:
        </p>
        <p>
          <code>Content-Profile: &lt;https://joinup.ec.europa.eu/release/geodcat-ap-v10>, &lt;https://joinup.ec.europa.eu/release/statdcat-ap/101></code>
        </p>
      </section>
    </section>
  </section>
  <section id="functional-profiles">
    <h2>Functional Profiles</h2>
    <p>
      This section describes <a>profiles</a> of this <a>specification</a>'s abstract model which are implementations of it
      in different environments; they are profiles and may be referred to as "functional profiles". These profiles are
      formally identified in <a href="#conformance-profiles"></a> and are to be used as conformance targets for specific
      implementations of systems within different environments wishing to conform to this specification.
    </p>
    <p>
      This document provides functional profiles for two environments - HTTP &amp; human browser (Query String
      Argument functionality) only. For the human browser environment, two functional profiles are presented.
      Further functional profiles of this specification MAY be implemented either for other environments and or even for
      constrained scenarios within these environments and implementers are encouraged to do this by further profiling this
      specification.
    </p>
    <p class="note" title="Conformance to profiles">
      Implementers of Content Negotiation by Profile need not ensure systems conform to multiple functional profiles
      of this specification. They need only conform to the functional profile(s) relevant to their environment. In some
      cases, for example the Query String Argument-relevant human browser environment, there is a choice of more than
      one functional profile. Since all functional profiles of this specification themselves must conform to this specification, by
      design, conformance to any functional profile guarantees conformance to the specification.
    </p>
    <section id="http">
      <h3>Hypertext Transfer Protocol Headers</h3>
      <p>
        An functional profile of the Abstract Model using Hypertext Transfer Protocol (HTTP) headers is presented here.
        This implementation is based on HTTP content negotiation and uses two new HTTP headers,
	      <code>Accept-Profile</code> and <code>Content-Profile</code> that are to be defined in an upcoming
        Internet-Draft [[PROF-IETF]].
      </p>
      <div class="issue" data-number="678"></div>
      <div class="note" title="Issue 678: POST/PUT out of scope">
        <p>
          POST &amp; PUT methods are considered out-of-scope for this Functional Profile. It is not clear what functions of
        the proposed Abstract Model these HTTP methods would implement.
        </p>
        <p>
          <code>Content-Profile</code> headers may be specified in POST &amp; PUT request to communicate the conformance of a
          request message's content but the Working Group has no specified requirements for this.
        </p>
      </div>
      <p>
	      Although servers are free to implement negotiation as they see fit,
	      if the User Agent sends an <code>Accept-Profile</code> header,
	      they SHOULD consider representations not conforming to any of the listed profiles
	      as non-interpretable by the client.
	      This means that a representation that conforms to a listed profile,
	      but has a low preference score on other dimensions,
	      SHOULD be considered as more desired than
	      a representation with a higher preference score on other dimensions
	      but that does not conform to any listed profile.
	      If no <code>Accept-Profile</code> header preference is given,
	      the profile dimension SHOULD be ignored for negotiation purposes.
	      Nevertheless, in all cases,
	      the server's response SHOULD contain a <code>Content-Profile</code> header
	      listing the URIs of all profiles to which it knows the representation conforms.
      </p>
      <section id="http-listprofiles">
        <h3>list profiles</h3>
        <p>
          The preferred way to retrieve a list of profiles the server supports for a specific resource
	  is to issue a <code>GET</code> or <code>HEAD</code> request for that resource.
	  In either case, a server implementing
          content negotiation by profile SHOULD return an HTTP <code>Link</code> header containing information about the
          default representation of that resource and information about any alternate representations of that
          resource conforming to other profiles. The returned representation will be identified by <code>rel="self"</code>, other representations by
          <code>rel="alternate"</code>.
        </p>
        <p>As an example, consider the resource <code>http://example.org/resource/a</code> available
          in the Media Types <code>application/xml</code>, <code>text/html</code> and <code>text/turtle</code>.
          The <code>text/html</code> representation has
          no profile, whereas the <code>application/xml</code> and <code>text/turtle</code> representations are
          both available in the profiles <code>urn:example:profile:x</code> and <code>urn:example:profile:y</code>.
        </p>
        <p>
          Assuming that a request without an <code>Accept-Profile</code> header per default delivers content conforming to
          <code>urn:example:profile:x</code>, an HTTP request/response pair would look as per
          <a href="#eg-link-headers"></a>.
        </p>
        <pre id="eg-link-headers" class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Server returns a Link header to indicate available profiles">
HEAD /resource/a HTTP/1.1
Accept: text/turtle
[more request headers]

---

HTTP/1.1 200 OK
Content-Type: text/turtle
Content-Profile: urn:example:profile:x
Link:
  &lt;http://example.org/resource/a&gt;;
          rel="self";
          type="text/turtle";
          profile="urn:example:profile:x",
  &lt;http://example.org/resource/a&gt;;
          rel="alternate";
          type="text/turtle";
          profile="urn:example:profile:y",
  &lt;http://example.org/resource/a&gt;;
          rel="alternate";
          type="application/xml";
          profile="urn:example:profile:x",
  &lt;http://example.org/resource/a&gt;;
          rel="alternate";
          type="application/xml";
          profile="urn:example:profile:y",
  &lt;http://example.org/resource/a&gt;;
          rel="alternate";
          type="text/html"
[more response headers]
        </pre>
        <p>
          In <a href="#eg-link-headers"></a>, for each of the different Media Type / Profile combinations, the URI of
          the resource remains unchanged and it is the <code>Accept</code> and <code>Accept-Profile</code> headers for
          Media Type and Profile respectively that alter the returned response.
        </p>
        <p>
          A server MAY use <code>Content-Location</code> HTTP headers to indicate direct links to representations of the
          resource according to Media Type / Profile combinations and, if it does so, it may replace the unchanged URI
          in the Link header with those direct URIs, as per example <a href=""></a>.
        </p>
        <pre id="eg-link-headers-loc" class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Server returns Link header with Content-Location URIs for some Profiles and Media Types">
HEAD /resource/a HTTP/1.1
Accept: text/turtle
[more request headers]

---

HTTP/1.1 200 OK
Content-Type: text/turtle
Content-Location: http://example.org/resource/a.prof1.ttl
Content-Profile: &lt;urn:example:profile:x>
Link:
  <strong>&lt;http://example.org/resource/a.prof1.ttl&gt;;</strong>
          rel="self"; type="text/turtle";
          profile="urn:example:profile:x",
  &lt;http://example.org/resource/a&gt;;
          rel="alternate";
          type="text/turtle";
          profile="urn:example:profile:y",
  <strong>&lt;http://example.org/resource/a.prof1.xml&gt;;</strong>
          rel="alternate";
          type="application/xml";
          profile="urn:example:profile:x",
  &lt;http://example.org/resource/a&gt;;
          rel="alternate";
          type="application/xml";
          profile="urn:example:profile:y",
  &lt;http://example.org/resource/a&gt;;
          rel="alternate";
          type="text/html"
[more response headers]

[In the Link header, Content-Location URIs are only used as context
URIs for resources conforming to profile urn:example:profile:x]
        </pre>
        <section id="listprofiles-tokens">
          <h3>Token mappings</h3>
          <p>
            If HTTP <a>server</a>s wish to allow <a>client</a>s to identify <a>profile</a>s via <a>token</a>,
            in addition to the the mandatory identification of <a>profile</a>s via via URI, the <a>server</a>s will
            need to provide a <a>token</a> / URI mapping via this <strong>list profiles</strong> function. In this
            HTTP functional profile of this specification, this may be implemented in a number of ways. The preferred
            way is to add "token" parameters to the HTTP Content-Profile and Link HTTP headers.
          </p>
          <pre id="eg-uri-token" class="example nohighlight" aria-busy="false" aria-live="polite"
               title="HTTP headers with profile URI / token mappings using 'token' parameters">
# The Profile with urn:example:profile:x is mapped to token px and URI
# and the Profile with URI http://example.org/profile/y is mapped to py

HEAD /resource/a HTTP/1.1
Accept: text/turtle
[more request headers]

---

HTTP/1.1 200 OK
Content-Type: text/turtle
Content-Location: http://example.org/resource/a.profx.ttl
Content-Profile: &lt;urn:example:profile:x;token=px>
Link: &lt;http://example.org/resource/a.profx.ttl&gt;; rel="self"; type="text/turtle"; profile="urn:example:profile:x;token=px",
  &lt;http://example.org/resource/a.profy.ttl&gt;; rel="alternate"; type="text/turtle"; profile="http://example.org/profile/2;token=py",
  &lt;http://example.org/resource/a.profx.xml&gt;; rel="alternate"; type="application/xml"; profile="urn:example:profile:x;token=px",
  &lt;http://example.org/resource/a.profy.xml&gt;; rel="alternate"; type="application/xml"; profile="http://example.org/profile/2;token=py",
  &lt;http://example.org/resource/a.html&gt;; rel="alternate"; type="text/html"
[more response headers]
          </pre>
          <div class="note" title="Alternate ways of conveying URI / token mappings">
            <p>
              There are several alternate methods that many be used to convey URI / token mappings in addition to the recommended
              method described and exemplified above.
            </p>
            <p><strong>Option 1: registered tokens</strong></p>
            <p>
              Tokens are registered in a global registry and servers may use them in place of a URI, e.g.
              <code>Content-profile: token1, &lt;URI2></code>
            </p>
            <p>
              <em>Pros</em>: compact<br />
              <em>Cons</em>: a global registry for profiles not manageable when many systems define profiles and such a registry
              limits other capabilities of profile description by forcing generic profiles
            </p>
            <p><strong>Option 2: allow namespace declarations</strong></p>
            <p>
              As per the use of CURIEs [[CURIE]] whose specification "...defines a generic, abbreviated syntax for
              expressing URIs." within JSON-LD [[JSON-LD]], a token may be indicated for use in place of a URI within
              a namespacing context. In this method, key/value pairs of tokens/URIs are defined within an HTTP header
              such as <code>Content-Profile</code> e.g:
            </p>
            <p>
              <code>Content-Profile: @:http://example.org/profiles/,@w3c:http://w3.org/knownprofiles#, :token1, w3c:token2</code>
            </p>
            <p>
              Here the first key/value pair of token/URI is key: &lt;nothing&gt;, value: http://example.org/profiles/
              and the second, is key: &lt;w3c&gt;, value: http://w3.org/knownprofiles#.
            </p>
            <p>
              <em>Pros</em>: compact, no registry requirement<br />
              <em>Cons</em>: clients have more parsing to do<br />
              <em>Note</em>: could easily be a JSON-LD payload<br />
              (alternative syntax using parameter ns2;ns=http://example.org/profiles/)
            </p>
            <p><strong>Option 3: namespace header</strong></p>
            <p>
              In this method, a new HTTP header could be introduced to specifically convey token/URI profile key/value
              pairs. If <code>Content-Profile-Namespaces</code> is to be the new HTTP header, then a <a>server</a> may
              respond to a request with the following pair of headers:
            </p>
            <p>
              <code>
                Content-Profile-Namespaces: :http://example.org/profiles/,w3c:http://w3.org/knownprofiles#<br />
                Content-Profile: :token1, w3c:token2
              </code>
            </p>
            <p>
              <em>Pros</em>: dedicated, unambiguous, mechanics<br />
              <em>Cons</em>: clients have another header to deal with, registration of another HTTP header (and thus alternation to [[PROF-IETF]]<br />
            </p>
          </div>
        </section>
      </section>
      <section id="http-getresourcebyprofile">
        <h3>get resource by profile</h3>
        <p>
          	Getting a resource representation conforming to a specific profile is done
		by issuing an <code>HTTP GET</code> request against the resource
		and specifying the desired profile URI in an <code>Accept-Profile</code> header.
          	It is possible to specify a range of acceptable profile URIs
		and also to indicate preferences by using quality indicators (q-values). <a href="#eg-http-get"></a> shows a simple
          request for a resource, <code>/resource/a</code>, with a preference for representations according to profiles
          identified by the URIs (URNs, in this example) <code>urn:example:profile:x</code> &amp;
          <code>urn:example:profile:y</code> with 'q' values indicating a higher preference for the first. A response
          is returned by the server which indicates conformance with <code>urn:example:profile:x</code> by inclusion of
          that identifier in the <code>Content-Profile</code> HTTP header.
        </p>
        <pre id="eg-http-get" class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Requesting a resource representation conforming to a specific profile using HTTP headers">
GET /resource/a HTTP/1.1
Accept: text/turtle;q=0.8, application/xml;q=0.5
Accept-Profile: urn:example:profile:x;q=1.0,urn:example:profile:y;q=0.6
[more request headers]

---

HTTP/1.1 200 OK
Content-Type: text/turtle
Content-Profile: &lt;urn:example:profile:x>
[more response headers]
        </pre>
        <p>
          Having performed content negotiation and returned a resource representation, it is RECOMMENDED
          that the server also include a Link header indicating the availability of alternate resources
          encoded in other Media Types and conforming to other profiles, as described above.
        </p>
      </section>
    </section>
    <section id="qsa">
      <h3>URL Query String Arguments</h3>
      <section id="qsa-description">
        <h4>QSA Functional Profile description</h4>
        <p>
          While the HTTP functional profile's approach to profile negotiation enables fully automated content negotiation by
          profile, the motivating use cases for this specification included human actionable negotiation. Also, as related
          in <a href="#relatedwork"></a>, previous and existing systems already allow for human-actionable content
          negotiation by profile by a number of means.
        </p>
        <p>
          To both allow for human-actionable content negotiation by profile and also to show how mechanics similar to
          existing systems might fulfill all aspects of this specification's Abstract Model, here we present a Query
          String Argument (QSA) functional profile of the Abstract Model. This functional profile is functionally equivalent to the
          HTTP functional profile in that all required functions of the Abstract Model are supported however it is not mutually
          exclusive of the HTTP, or any other, functional profile: an implementation of this specification may
          be conformant to multiple functional profiles of it to implement content negotiation by profile functionality
          in multiple environments or in different ways within the same environment.
        </p>
        <p>
          Unlike the HTTP functional profile which is also the subject of an independent IETF document [[PROF-IETF]],
          this QSA functional profile is fully specified here. Two forms of this QSA approach are presented too: the first is the
          fixed keyword "QSA Functional Profile" and the second is the "QSA Alternate Keywords Functional Profile" according to which
          servers may implement any keywords they choose. These various functional profiles are
          all identified in <a href="#conformance-profiles"></a>.
        </p>
        <div class="note">
          Conformance of a system to any one, or perhaps multiple, of these profiles may be demonstrated as per
          <a href="#conformancetoprofiles"></a>. Note that it is not required that a system, perhaps a server, indicate
          conformance to one or more profiles of this specification since not all servers will have the ability to
          either produce information as per <a href="#conformancetoprofiles"></a>. Systems may also show conformance to
          the specification or profile in other ways, such as by a listing in a services catalogue. services catalogue).
        </div>
        <section id="qsa-uri">
          <h5>QSA URI description</h5>
          <p>
            A query string is a part of a URL which assigns values to specified parameters. QSAs are commonly used within
            web browsers by humans and in other <a>client</a>/<a>server</a> situations to deliver extra information to a
            <a>server</a>. Query string key/value pairs are separated from the scheme, authority and path of a URI by
            a question mark symbol, <code>?</code>, and consist of key/value pairs connected by an equals symbol,
            <code>=</code>, and separated from each other key/value pair by an ampersand symbol, <code>&amp;</code>, as per
            [[RFC3986]].
          </p>
          <p>
            An example resource-requesting URI with content negotiation by profile implemented using QSA is shown in
            <a href="#eg-qsa-uri"></a>.
          </p>
          <pre id="eg-qsa-uri"
               class="example nohighlight" aria-busy="false" aria-live="polite"
               title="Example resource-requesting URI with content negotiation by profile implemented using QSA">
http://example.com/path/to/resource/a?<strong>_profile=prof-01</strong>
          </pre>
          <p>
            In <a href="#eg-qsa-uri"></a>, the profile requested for the resource representation is indicated by the
            token <code>prof-01</code> which MUST be appended to the resource's URI as a Query String Argument. As per
            this specification's <a href="#listprofiles"></a>'s allowance, a <a>token</a> is used here to identify the
            profile - <code>prof-01</code> - but that token MUST be mappable to a URI within one particular
            client/server session and mechanics for that are described below.
          </p>
          <p>
            Additional aspects of content negotiation MAY be included in such URIs by the use of additional QSA or by
            any other techniques (for example HTTP headers) but, if they are, they MUST NOT change the actions of the
            request for content negotiation by profile. To demonstrate an acceptable inclusion, if the client using the
            URI in <a href="#eg-qsa-uri"></a> wished to indicate a preference for the content of the request to be
            serialised as RDF, according to the  Turtle [[?TURTLE]] specification, it could use the
            <a href="http://www.iana.org/assignments/media-types">IANA Media Types list</a>'s token for Turtle which is
            <code>text/turtle</code> and formulate the URI as per <a href="#eg-qsa-uri-mt"></a> which is accordance with
            URI formulation requirements [[RFC3986]].
          </p>
          <pre id="eg-qsa-uri-mt"
               class="example nohighlight" aria-busy="false" aria-live="polite"
               title="Example QSA URI with content negotiation by profile and Media Type">
http://example.com/path/to/resource/a?<strong>_profile=prof-01&amp;_mediatype=text/turtle</strong>
          </pre>
          <div class="note" title="Maximum length of URLs">
            If Query String Arguments may use URIs (or URLs) to convey important information, implementers should ensure
            that the total length of the total requesting URI within which the QSAs using URIs/URLs exist does not exceed
            length restrictions. [[RFC7230]]'s <a data-cite="RFC7230#section-3.1.1">§3.1.1</a> recommends that senders and
            recipients support request lines of at least 8,000 octets. Some client and server implementations, however,
            cannot accept URLs longer than 2,000 characters, for example, the Sitemap protocol which has a length limit of
            2,048 characters in a URL. Cf.
            <a href="https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url-in-different-browsers">
            this question on stackoverflow</a> for a longer discussion of issues related to URL length.
          </div>
        </section>
        <section id="qsa-key-naming">
          <h5>Key naming</h5>
          <p>
            This specification includes two different functional profiles of it for use by human clients using Query
            String Arguments that are differentiated by their requirements for QSA key naming. The two
            profiles are the "QSA Functional Profile" and "QSA Alternate Keywords Functional Profile" with the former
            being a profile of the latter. This is due to the former containing more stringent conformance rules
            ("narrower" rules) about how to achieve this specification's required functionality. These
            profiles are identified and defined in <a href="#conformance-profiles"></a>.
          </p>
          <p>
            To conform to the "QSA Functional Profile", the QSA key <code>_profile</code> MUST be used to indicate a
            profile token or URI and SHOULD use <code>_mediatype</code> to indicate a resource representation's Media
            Type.
          </p>
          <p>
            When conforming to the profile "QSA Alternate Keywords Functional Profile", any key values acceptable
            within the specification of [[RFC3986]] may be used to indicate profile MAY be used, however if this
            functional profile is conformed to, servers MUST additionally present a mechanism to allow clients to
            discover what value is used, as detailed below in <a href="#qsa-keydiscovery"></a>.
          </p>
        </section>
        <section id="qsa-token-use">
          <h5>URI and token use</h5>
          <p>
            Currently, the convention in HTTP content negotiation by Media Type uses tokens for Media Types, such as
            <code>text/html</code> or <code>application/ld+json</code> with the tokens registered at
            <a href="http://www.iana.org/assignments/media-types">IANA's Media Types list</a> and Content Negotiation by
            Profile system implementers SHOULD use tokens from that list for Media Type identifiers and follow HTTP
            content negotiation best practice for identifiers for other content negotiation dimensions (language etc.).
          </p>
          <div class="note" title="URI use for Media Types">
            Several initiatives exist that have created URIs for Media Types based on IANA's tokens, such as
            <a href="https://conneg.info">
            conneg.info</a>. These URIs may be used to indicate Media Types.
          </div>
          <p>
            There is no proposal to create a central register of profiles, as this is thought by these authors to be
            unsustainable in the long term, given the likely numbers of profiles to be established and likely community-
            specific nature of profiles (individual communities will create profiles for their own needs that will not
            be widely relevant).
          </p>
          <p>
            As per <a href="#profileid"></a>, all profiles MUST be identified by URI since URIs are universally unique
            and therefore do not require registration to avoid identifier duplication. However, systems conforming to
            either of the QSA functional profiles of this specification, instead of using URIs to identify profiles
            during client/server interactions, MAY use un-registered and non-universally unique tokens to identify
            profiles but, if they do, they MUST provide a way for clients to discover profile token/URI mappings.
          </p>
          <h5>Resource URL</h5>
          <p>
            Resource URLs for which QSA-based profile negotiation is taking place SHOULD NOT themselves be QSA values
            of other resource URIs in any QSA-based system. Such mechanics may be used internally and are used by
            legacy systems for profile negotiation but are best hidden from to the <a>client</a> to make
            conformance to these QSA profiles more recognizable. <a href="#eg-resource-url"></a> shows this.
          </p>
          <pre id="eg-resource-url"
           class="example nohighlight" aria-busy="false" aria-live="polite"
           title="Resource URLs must not, themselves, be parameters of other URLs">
For the representation of Resource X, according to Profile Y, in Media Type Z:

Rather than:
GET /single/endpoint \
            ?resource=http://example.org/resource/X \
            &amp;_profile=Y \
            &amp;_mediatype=Z HTTP/1.1

Use:
GET /resource/X?_profile=Y&amp;_mediatype=Z HTTP/1.1
          </pre>
        </section>
      </section>
      <section id="qsa-listprofiles">
        <h4>list profiles</h4>
        <p>
          For conformance to the "QSA Functional Profile", the <code>_profile</code> QSA key SHOULD be supported by the
          <a>server</a> to allow a <a>client</a> to make a <strong>list profiles</strong> <a>request</a>. For this
          request, the reserved token <code>all</code> SHOULD be used, e.g. <code>_profile=all</code>.
        </p>
        <p>
          For conformance to the "QSA Alternate Keywords Functional Profile", other key/value pairs MAY be used, such as
          <code>_view=alternates</code> but then the implementing server MUST supply a means of discovering that key,
          as per <a href="#qsa-keydiscovery"></a>.
        </p>
        <p>
          The <a>server</a>'s <a>response</a> to a <em>list profiles</em> <a>request</a> SHOULD be to present a list
          of all profiles that it supports representations of the resource for and optionally also supported Media Types
          for those representations.
        </p>
        <p>
          The server SHOULD represent the alternate profiles information in the HTTP header of the <a>response</a>, as
          per the HTTP functional profile (using a Link header) and it MAY also represent the information in the response body
          in place of the default profile representation of a resource. This body content allowance is to enable humans
          to read alternate profile-conformant representation options for a resource easily in a web browser without
          having to view lower-level HTTP information.
        </p>
        <p>
          Where a server does provide alternate profiles information in an HTTP body, the server MAY allow clients to
          negotiate for particular Media Types of the response by using the same Media Type negotiation method used for
          the <em>get resource by profile</em> function below.
        </p>
        <p>
          An example <a>request</a> for the alternate profile representations of a <a>resource</a> to be delivered
          as HTTP body content as well as HTTP header content in the JSON format could look like
          <a href="#eg-list-profiles-mediatype"></a>
        </p>
        <pre id="eg-list-profiles-mediatype" class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Requesting 'list profiles' by QSA with both HTTP header and body responses">
GET /resource/a?_profile=all&amp;_mediatype=application/json HTTP/1.1

---

# The response shows that representations of the resource can be delivered according
# to two profiles identified by the tokens <em>profile-x</em> &amp; <em>profile-y</em>
# and that <em>profile-x</em>-conformant representations are available in XML &amp; JSON
# where as <em>profile-y</em>-conformant representations are only available in XML

# The content in the JSON body of the response is equivalent to that of the Link header

# Both the Link header and the JSON body include profile URI/token mappings

HTTP/1.1 200 OK
Content-Type: application/json
Content-Profile: &lt;http://www.w3.org/ns/dx/conneg/profile/qsa>
Link:
  &lt;http://example.org/resource/a?_profile=profile-x&amp;_mediatype=application/json>;
          rel="self"; type="application/json";
          profile="http://otherexample.org/profile/x",
  &lt;http://example.org/resource/a?_profile=profile-x&amp;_mediatype=text/xml>;
          rel="alternate";
          type="text/xml";
          profile="http://otherexample.org/profile/x",
  &lt;http://example.org/resource/a?_profile=profile-y&amp;_mediatype=text/xml>;
          rel="alternate";
          type="text/xml";
          profile="http://otherexample.org/profile/y"

{
    "resource": "http://example.org/resource/a",
    "profiles": [
        {
            "token": "profile-x",
            "uri": "http://otherexample.org/profile/x",
            "media_types": ["application/json", "text/xml"]
        },
        {
            "token": "profile-y",
            "uri": "http://otherexample.org/profile/y",
            "media_types": ["text/xml"]
        }
    ]
}
        </pre>
      </section>
      <section id="qsa-getresourcebyprofile">
        <h4>get resource by profile</h4>
        <p><strong><em>Expressing profile preference</em></strong></p>
        <p>
          To be conformant with the "QSA Functional Profile" profile of this specification, a <a>server</a> MUST allow
          clients to request resources according to profiles they identify with a <code>_profile</code> query string.
          Since either <a>tokens</a> or URIs may be used to identify a profile, servers MUST accept either. Servers MAY
          accept both encoded and un-encoded URIs but MAY also only accept one or the other.
        </p>
        <p>
          To be conformant with the "QSA Alternate Keywords Functional Profile" profile of this specification, a
          <a>server</a> MUST allow clients to request resources according to profiles they identify with a key of the
          server implementor's choosing but then the server MUST also supply a means of discovering that key, as per
          <a href="#qsa-keydiscovery"></a>.
        </p>
        <p>
          A QSA <a>server</a> implementing <em>get resource by profile</em> SHOULD allow a client to indicate a
          preference for representations of the resource according to any one of a number of profiles. Such a request
          MUST indicate profile preference in by inclusion of an ordered list of profile identifiers (URIS or tokens)
          within the value of the QSA key/value pair used to identify profiles. For example, a client preferring
          resource representations according to <em>profile-z</em> and then <em>profile-y</em> and finally
          <em>profile-x</em>, in that preference order, could make a request like this:
        </p>
        <p>
          <code>GET /resource/a?_profile=profile-z,profile-y,profile-x</code>
        </p>
        <p>
          Servers SHOULD support any combination of profile URIs or tokens for this (e.g.
          <code>profile-z,http://example.org/profile/x,profile-y</code>) and SHOULD return resource representations
          according to preference. Servers MUST indicate the profile actually returned by including a
          <code>Content-Profile</code> HTTP header in the response and MAY also indicate the returned profile in other
          ways. Servers SHOULD support escaped URIs and MAY also support un-escaped URIs identifying profiles, or both.
        </p>
        <p>
          A server implementing multiple Media Type formats for its resource representations SHOULD allow a client to
          specify a preference order for them in a similar way.
        </p>
      </section>
      <section id="qsa-keydiscovery">
        <h4>QSA key discovery</h4>
        <p>
          <em>This function is only relevant for servers claiming conformance to the "QSA Alternate Keywords
          Functional Profile" profile of this specification.</em>
        </p>
        <p>
          Servers claiming conformance to the "QSA Alternate Keywords Functional Profile" MUST implement methods to
          allow clients to discover the QSA key used in place of the "QSA Functional Profile"'s <code>_profile</code>
          and also the equivalent of the <code>_profile=all</code> that is required to be implemented by any key/value
          combination. This allows clients with little knowledge of the server to discover how to create
          <em>list profile</em> and <em>get resource by profile</em> requests.
        </p>
        <p>
          Servers SHOULD also allow clients to discover the QSA keys used to indicate Media Type and other content
          negotiation dimensions.
        </p>
        <p>
          A server responding to any request for a resource for which "QSA Alternate Keywords Functional Profile" is
          supported SHOULD include HTTP headers that indicate alternate profiles and Media Types, as per the HTTP
          Functional Profile. They MAY instead, or in addition, provide HTTP body content indicating the same
          information. If they do, such information SHOULD be present in the default response to a URI request, i.e. in
          response to a request without any QSAs. A series of example requests is given in
          <a href="#eg-qsa-keydiscovery"></a>.
        </p>
        <!--
          , as implemented by the <a href="https://pypi.org/project/pyldapi/">
          pyLDAPI Python library for Linked Data</a>,
          -->
        <pre id="eg-qsa-keydiscovery" class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Example requests and responses for QSA key discovery">
# A client makes a request for Resource A not knowing if any Content
# Negotiation by Profile is supported. It supplies an Accept-Profile
# header just in case. For extra efficiency, the client could have
# made a HEAD request instead of a GET

GET /resource/a HTTP/1.1
Accept-Profile: http://example.org/profile/x

# The server does not understand the HTTP Get Resource By Profile
# request (doesn't support the HTTP Headers Functional Profile) but is
# able to supply an HTTP Link header indicating alternate profiles. It
# can be seen from the Link header that keys other than _profile &
# _mediatype are in use - view & format - thus this is QSA Alt, not a
# QSA Functional Profile-conformant system

# The resource representations available conform to profile-x & profile-y.
# The profile-y-conformant representation is only available in XML

HTTP/1.1 200 OK
Link:
  &lt;http://example.org/resource/a?view=profile-x>;
          rel="self";
          type="text/html";
          profile="http://otherexample.org/profile/x",
  &lt;http://example.org/resource/a?view=profile-y&amp;format=text/xml>;
          rel="alternate";
          type="text/xml";
          profile="http://otherexample.org/profile/y"

# Note that here the server does not directly indicate the profile served
# (there is no Content-Profile header present) but this can be inferred
# by the link header with rel="self"
        </pre>
        <p>
          While the Link header response above communicates all the information that a <em>list profiles</em> request
          does, it is not visible directly in a web browser. <a href="#eg-list-profiles-mediatype"></a> shows a
          requests/response pair that include equivalent Link header and HTTP body information listing profiles, the
          latter of which is visible in a browser but a client formulating this request is dependent on a it knowing
          that the QSA key/value pair <code>_profile=all</code> is used to trigger this response as opposed to the
          server's default resource representation.
        </p>
        <p>
          To communicate to a client what QSA key/value pair is used for <em>list profiles</em> when the "QSA Alternate
          Keywords Functional Profile" is conformed to, a server SHOULD indicate, following the methods above for
          <em>list profiles</em> communication, that a representation of the resource is available that conforms to the
          Alternate Profiles Data Model described in <a href="#eg-qsa-keydisco-altprofiles"></a>. This is demonstrated
          as an extension to <a href="#eg-qsa-keydiscovery"></a> in <a href="#eg-qsa-keydisco-altprofiles"></a>.
        </p>
        <pre id="eg-qsa-keydisco-altprofiles" class="example nohighlight" aria-busy="false" aria-live="polite"
             title="Extension of previous example showing of Alternate Profiles Data Model-conformant responses">
GET /resource/a HTTP/1.1
Accept-Profile: http://example.org/profile/x

--

HTTP/1.1 200 OK
Link:
  &lt;http://example.org/resource/a?view=profile-x>;
          rel="self";
          type="text/html";
          profile="http://otherexample.org/profile/x",
  &lt;http://example.org/resource/a?view=profile-y&amp;format=text/xml>;
          rel="alternate";
          type="text/xml";
          profile="http://otherexample.org/profile/y",
  &lt;http://example.org/resource/a?view=altprofiles>;
          rel="alternate";
          type="application/ld+json";
          profile="http://www.w3.org/ns/dx/conneg/altprofiles"

[default response content]
        </pre>
        <p>
          <a href="#eg-qsa-keydisco-altprofiles"></a> shows that for resource <code>/resource/a</code> there is a
          representation of it that conforms to the specification/profile
          <code>http://www.w3.org/ns/dx/conneg/altprofiles</code> which is the URI identifying the Alternate Profiles
          Data Model defined in <a href="#altprofiles-model"></a>. Since the example also shows the QSA
          <code>view=altprofiles</code> can be used to formulate a request for this representation, dereferencing
          <code>http://example.org/resource/a?view=altprofiles</code> will generate a response that also yields the
          content of the request in <a href="#eg-qsa-keydisco-altprofiles"></a> but, since it is conformant to the
          Alternate Profiles Data Model, the HTTP body of that response will also list the alternate profiles for
          <code>/resource/a</code> as opposed to the default representation of it.
        </p>
        <div class="note" title="For further investigation: alternates profiles profile">
          <p>
            Nick: it appears we are dependent on an identifier for the "profile of a resource that lists all others
            profiles". This is analogous in content to the Link header response for <em>list profiles</em> and is exactly
            what the existing QSA systems respond with when asked for <code>?_view=alternates</code> and what is given
            above as <code>?_profile=all</code>. So it's a URI that is equivalent to the QSA Functional Profile profile's token
            of <em>all</em>.
          </p>
          <p>
            If we had such a URI, I would be able to say something like a Link header response should include this to
            indicate how a client can show how to trigger <code>?_profile=all</code> (list profiles):
          </p>
          <pre class="nohighlight">Link:
    &lt;http://example.org/resource/a&gt;;
      rel="self";
      type="text/turtle";
      profile="urn:example:profile:x",
    <strong>&lt;http://example.org/resource/a&gt;;
      rel="alternate";
      type="text/turtle";
      profile="http://example.org/profile/alternates",</strong>
    &lt;http://example.org/resource/a&gt;;
      rel="alternate";
      type="text/turtle";
      profile="urn:example:profile:y",
    &lt;http://example.org/resource/a&gt;;
      rel="alternate";
      type="application/xml";
      profile="urn:example:profile:x",
    &lt;http://example.org/resource/a&gt;;
      rel="alternate";
      type="application/xml";
      profile="urn:example:profile:y",
    &lt;http://example.org/resource/a&gt;;
      rel="alternate";
      type="text/html"
            </pre>
          <p>
            The bolded part of the Link header above is the alternate profile for the resource that lists other profiles
            which we know since the profile identifier is <strong><code>http://example.org/profile/alternates</code>
            </strong> in some format (here <code>text/turtle</code>.
          </p>
        </div>
      </section>
    </section>
  </section>
  <section id="testsuites">
    <h2>Test Suites</h2>
    <p>
      Software to be used to assess conformance of systems to this specification is managed in the online code
      repository: <a href="https://github.com/w3c/conneg-prof-testing">https://github.com/w3c/conneg-prof-testing</a>.
    </p>
  </section>
  <section id="implementations" class="informative">
    <h2>Implementations</h2>
    <p>
      This section includes implementations of the functional profiles given in this document and their conformance
      test results. The tools used for conformance testing are listed in the section above.
    </p>
    <ul>
      <li>
        <a href="https://github.com/CSIRO-enviro-informatics/prof-conneg-conf-test-results">
          https://github.com/CSIRO-enviro-informatics/prof-conneg-conf-test-results
        </a>
      </li>
    </ul>
  </section>
  <section id="acknowledgements" class="informative">
    <h2>Acknowledgements</h2>
    <p>
      The editors gratefully acknowledge the contributions made to this document by all members of the Dataset Exchange
      Working Group, especially Annette Greiner.
    </p>
    <p>
      The editors would also like to thank the following non-Working Group people for supplying comments which were
      used to improve this document: Erik Wilde, Gregg Kellogg &amp; Irene Polikoff.
    </p>
    <p>
      Special thanks must be given to Kam Hay Fung for his most extensive comments and suggestions which found and
      fixed issues for us.
    </p>
    <p>
      Finally, the editors thank the chairs of the Dataset Exchange Working Group: Peter Winstanley &amp; Karen Coyle.
    </p>
  </section>
  <section id="changes" class="informative">
	  <h2>Changes</h2>
    <p>Changes since the <a href="https://www.w3.org/TR/2019/WD-dx-prof-conneg-20190430/">2nd Public Working Draft, 30 April 2019</a> are:</p>
    <ul>
      <li>Metadata: Two authors (Car & Svensson) changed affiliation</li>
      <li><a href="#abstract"></a>: slight wording change</li>
      <li><a href="#sotd">Status of this Document</a>: slight changes to listing of other docs</li>
      <li><a href="#introduction"></a>: small changes to wording</li>
      <li><a href="#conformance"></a>: addition of <a href="#conformance-profiles"></a></li>
      <li><a href="#motivation"></a>: addition of a 3rd paragraph describing relation of this work to existing systems</li>
      <li><a href="#relatedwork"></a>: updated ref to IETF doc since it's changed, aligned examples with other section's examples, minor wording changes, removed closed issues</li>
      <li><a href="#abstractmodel"></a>: replaced the "Context" subsection with 3 subsections: intro text, Background, Profile Identification but with essentially the same content, removal of closed issues, addition of 3 new examples (now 4, 5 & 6 with 7 being an updated version of the old 4), addition of a note & text about redirection</li>
      <li><a href="#functional-profiles"></a>: retitling of this section from <em>Realizations</em> to its current title, expanded intro text, description of conformance to this spec's functional profiles, addition of Issue 678 and a response not for it.
        <ul>
          <li>
            <a href="#http"></a>:
            <ul>
              <li>Within "list profiles": removal of Content-Location URLs in intro text, alteration of Example 8 (previously Example 5) to reflect Link header decisions, addition of new text and an example (9) about Content-Location HTTP headers, removal of an irrelevant Issue</li>
              <li>Within "Token mappings": removal of closed issue, enhancement of the alternate mappings note</li>
              <li>Within "get resource by profile": expanded explanatory text</li>
            </ul>
          </li>
          <li>
            <a href="#qsa"></a>:
            <ul>
              <li>Removal of closed issues</li>
              <li>Altered text throughout to reflect wording changes like Realization &rarr; Functional Profile</li>
              <li>Movement of text sections into numbered subsections</li>
              <li>Addition of <a href="#qsa-uri"></a> to explain QSA background with two new examples, 12 &amp; 13</li>
              <li>Split of section <em>Key naming</em> into <em>Key naming</em> &amp; <em>URI and token use</em> with extended content</li>
              <li>Within "list profiles": expanded text, removal of closed issues, extended example (15)</li>
              <li>Within "get resource by profile": expanded text</li>
              <li>Addition of new subsection "QSA key discovery" with normative text, two examples and a note</li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#testsuites"></a>: text replaced with link to official repo</li>
      <li><a href="#implementations">: text replaced with link to official repo</a></li>
      <li>
        <a href="#appendices"></a>:
        <ul>
          <li>Removal of "Requirements" appendix</li>
          <li>Addition of "Profiles of this specification" appendix</li>
        </ul>
      </li>
      <li><a href="#references"></a>: additional of several informative references</li>
    </ul>
	  <p>Changes since the <a href="https://www.w3.org/TR/2018/WD-dx-prof-conneg-20181218/">1st Public Working Draft, 18 December 2018</a> are:</p>
	  <ul>
      <li>
      Added Related Work subsections for
      Linked Data APIs (<a href="https://github.com/w3c/dxwg/issues/383">Issue 383</a>),
      OAI-PMH (<a href="https://github.com/w3c/dxwg/issues/516">Issue 516</a>),
      &amp; CSW (<a href="https://github.com/w3c/dxwg/issues/882">Issue 882</a>).
      </li>
      <li>Added text about existing standards for transporting profile information in http headers
        to <a href="#relatedwork">related work</a>.
        (<a href="https://github.com/w3c/dxwg/issues/45">Issue 45</a>)</li>
      <li>Removed advice on use of HTTP OPTIONS.
        (<a href="https://github.com/w3c/dxwg/issues/510">Issue 510</a>)</li>
      <li>Added text about ARK identifiers to <a href="#relatedwork">related work</a>.
        (<a href="https://github.com/w3c/dxwg/issues/514">Issue 514</a>)</li>
      <li>Clarified difference between the <code>profile</code> parameter in <code>Accept</code> header fields
        and the <code>Accept-Profile</code> header field.
        (<a href="https://github.com/w3c/dxwg/issues/662">Issue 662</a>)</li>
      <li>Updated the <a href="#security_and_privacy">Security and Privacy</a> section.
        (<a href="https://github.com/w3c/dxwg/issues/782">Issue 782</a>)</li>
      <li>Added a not about length restrictions in URLs to the <a href="#qsa">QSA</a> section.
        (<a href="https://github.com/w3c/dxwg/issues/592">Issue 592</a>)</li>
    </ul>
  </section>
  <section id="security_and_privacy" class="informative">
    <h2>Security and Privacy</h2>
    <p>
      The use of HTTP to negotiate and transport implies that all privacy and security issues
      that are relevant for that protocol are also relevant for profile negotiation. E. g.,
      information such as user agent, accept-headers, IP address etc. can potentially be used as
      identifying information, and particularly, the IP address adds information about geolocation
      and institutional membership.
      Further, offering a list of acceptable profiles at the beginning of a negotiation process
      can reveal information about the user's interests
      that could be used to add such information to a user profile.
    </p>
    <p>
      For a more complete view of those issues, cf. the
      <a href="https://www.w3.org/2017/dxwg/wiki/CnegPrivacyAndSecurityQuestionnaire">Privacy and Security Questionnaire for this deliverable</a>.
    </p>
  </section>
  <section id="appendices" class="appendix">
    <h2>Appendices</h2>
    <section id="profiles">
      <h3>Profiles of this specification</h3>
      <p>
        This specification contains a number of distinct <a>profiles</a> that are identified and described in words in
        <a href="#conformance-profiles"></a>. This appendix presents descriptions of these profiles, and the relations
        between them, according to the Profiles Vocabulary [[PROF]].
      </p>
      <p>
        The RDF (turtle syntax) code in <a href="#profiles-in-prof">Code Listing 1</a> defines <em>Content Negotiation
        by Profile</em> as a <code><a href="http://purl.org/dc/terms/Standard">dct:Standard</a></code>, the definition
        of which in [[PROF]] matches the definition of <a>specification</a> in this document. The 4 profiles of it are
        then, as per regular PROF modelling, termed <code><a href="https://www.w3.org/TR/dx-prof/#Class:Profile">
        prof:Profiles</a></code>. The 4 profiles are presented in a hierarchy with the profiles either directly
        profiling the standard or, in the case of the <em>QSA Realization</em> profile, profiling another profile that then
        profiles the standard. This is also shown graphically in <a href="#fig-profile-hierarchy"></a> below the code
        listing.
      </p>
      <p>
        The code presented in <a href="#profiles-in-prof">Code Listing 1</a> is also available in the RDF file <a href="profiles.ttl">profiles.ttl</a>.
      </p>
      <p>
        The reason that the <em>QSA Functional Profile</em> profile is modelled as profiling the <em>QSA Alternate Keywords
        Functional Profile</em> profile is that the <em>QSA Functional Profile</em> profile is a more constrained 'narrower'
        specification of <em>Content Negotiation by Profile</em> than <em>QSA Alternate Keywords Functional Profile</em> and
        anything that is conformant with the <em>QSA Functional Profile</em> profile would necessarily by conformant with the
        <em>QSA Alternate Keywords Functional Profile</em> profile which thus meets the [[PROF]] definition of what it means
        to be the profile of something.
      </p>
      <pre id="profiles-in-prof"
           class="codelisting nohighlight" aria-busy="false" aria-live="polite"
           title="Description of this specification and its profiles according to PROF">
<div class="codelisting-title">
<a href="#profiles-in-prof">CODE LISTING 1</a>: Description of this specification and its profiles, as listed in <a href="#conformance-profiles"></a>
using the Profiles Vocabulary [[PROF]]
</div>
@prefix dct: &lt;http://purl.org/dc/terms/> .
@prefix prof: &lt;http://www.w3.org/ns/dx/prof/> .
@prefix role: &lt;http://www.w3.org/ns/dx/prof/role/> .
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#> .
@prefix skos: &lt;http://www.w3.org/2004/02/skos/core#> .

@prefix cnpr: &lt;http://www.w3.org/ns/dx/conneg/profile/> .

&lt;https://www.w3.org/TR/dx-prof-conneg/> a dct:Standard ;
    rdfs:label "Content Negotiation by Profile" ;
    rdfs:comment "W3C Recommendation (a standard) for Content Negotiation by Profile"@en .

cnpr:http a prof:Profile ;
    prof:isProfileOf &lt;https://www.w3.org/TR/dx-prof-conneg/> ;
    rdfs:label "HTTP Functional Profile" ;
    rdfs:comment "For conformance with the functional profile of Content Negotiation by
                  Profile presented in § 7.1 Hypertext Transfer Protocol Headers."@en ;
    skos:scopeNote "To be used if a resource conforms to the HTTP Functional Profile"@en .

cnpr:qsa a prof:Profile ;
    prof:isProfileOf cnpr:qsa-alt ;
    rdfs:label "QSA Functional Profile"@en ;
    rdfs:comment "For conformance with the functional profile of Content Negotiation by
                  Profile presented in § 7.2 URL Query String Arguments."@en ;
    skos:scopeNote "To be used if a resource conforms to the QSA Functional Profile using
                    the Query String Arguments _profile and _mediatype as per the
                    recommendations in § 7.2 URL Query String Arguments."@en .

cnpr:qsa-alt a prof:Profile ;
    prof:isProfileOf &lt;https://www.w3.org/TR/dx-prof-conneg/> ;
    rdfs:label "QSA Alternate Keywords Functional Profile" ;
    rdfs:comment "For conformance with the functional profile of Content Negotiation by
                  Profile presented in § 7.2 URL Query String Arguments."@en ;
    skos:scopeNote "To be used if a resource conforms to the QSA Functional Profile but
                    uses alternate keywords for the Query String Arguments _profile and
                    _mediatype, as allowed by the recommendations in § 7.2 URL Query
                    String Arguments."@en .

cnpr:rrd a prof:Profile ;
    prof:isProfileOf &lt;https://www.w3.org/TR/dx-prof-conneg/> ;
    rdfs:label "Resource Representation Description Profile"@en ;
    rdfs:comment "For conformance with Content Negotiation by Profile § 6.2.2 get
                  resource by profile."@en ;
    skos:scopeNote "To be used if a resource representation is able to indicate which
                    profile(s) it conforms to, in its appropriate functional profile,
                    as per the abstract specification in § 6.2.2 get resource by
                    profile."@en .
      </pre>
      <figure id="fig-profile-hierarchy">
        <a href="profiles-hierarchy.svg">
          <img src="profiles-hierarchy.svg" alt="Profiles hierarchy of this specification" style="width:500px;" />
        </a>
        <figcaption>
          The specification and profiles of this Content Negotiation by Profile standard shown in a [[PROF] profiles
          hierarchy.
        </figcaption>
      </figure>
      <section id="conformancetoprofiles">
        <h4>Demonstrating conformance to profiles</h4>
        <p>
          With the identification of profiles of this specification given in <a href="#conformance-profiles"></a> and
          their relations described using the Profiles Vocabulary [[PROF]] in this appendix, it is possible for
          resources to show conformance to the this specification or any of the profiles by using mechanisms recommended
          in [[PROF]]. PROF's recommendation is that any resource, for example <code>&lt;http://example.org/resource/a&gt;</code>,
          wishing to claim conformance to a <a>specification</a> or a <a>profile</a> use the [[DCTERMS]]
          <code><a href="http://www.dublincore.org/specifications/dublin-core/dcmi-terms/#terms-conformsTo">
            dct:conformsTo</a></code> predicate like this:
        </p>
        <p>
          <code>&lt;hjttp://example.com/resource/a&gt; dct:conformsTo &lt;SPEC_OR_PROFILE_URI&gt; .</code>
        </p>
        <p>
          The <code>&lt;SPEC_OR_PROFILE_URI&gt;</code> may be this specification's URI but, in the best case, would be
          one of the profile URIs listed in <a href="#conformance-profiles"></a> since it is much clearer what is being
          conformed to when the profile URIs are cited as they are narrow in scope than the specification as a whole.
        </p>
        <p>
          The code in <a href="#service-conforming"></a> shows an imaginary Web Service documented using
          [[?VOCAB-DCAT-2]] and borrowing parts from its examples, such as
          <a href="https://www.w3.org/TR/vocab-dcat-2/#ex-service-eea">Example 49</a>,
          that includes a <code>dct:conformsTo</code> predicate as [[?VOCAB-DCAT-2]], as well as [[PROF]], suggest for
          use. Conformance here is claimed to be to the <em>QSA Alternate Keywords Functional Profile</em> profile indicated by
          the URI <code>http://www.w3.org/ns/dx/conneg/profile/qsa-alt</code>, as it is identified in
          <a href="#conformance-profiles"></a>.
        </p>
        <pre id="service-conforming" class="nohighlight" aria-busy="false" aria-live="polite"
             style="border:solid 1px black; padding:5px;">
&lt;http://example.com/service/xx>
    a dcat:DataService ;
    dct:title "Web Service XX" ;
    dct:description "A dummy Web Service claiming conformance to a profile of the Content
                     Negotiation by Profile specification also annotated with other
                     DCAT-2 recommended properties."@en ;

    # URI for the QSA Alternate Keywords Functional Profile
    <strong>dct:conformsTo &lt;http://www.w3.org/ns/dx/conneg/profile/qsa-alt> ;</strong>

    # it's a public service
    dct:accessRights &lt;http://publications.europa.eu/resource/authority/access-right/PUBLIC>

    # where the service actually is, online
    dcat:endpointURL &lt;http://example.com/service/v2/xx> ;

    # a human- and machine-readable documentation endpoint for the service using the
    # Swagger UI system
    dcat:endpointDescription &lt;http://example.com/service/v2/xx/swagger> ;
        </pre>
        <div class="listing-caption"
             style="font-style:italic; margin-left:10px; margin-right:10px;">
          Code Listing 2 An example Web Service claiming conformance to the QSA Alternate Keywords Functional Profile
          of this specification
        </div>
      </section>
    </section>
    <section id="issue-summary" class="appendix">
      <h3>Issue Summary</h3>
      <!-- A list of issues will magically appear here -->
    </section>
    <section id="extra-issues" class="appendix">
      <h3>Additional Issues</h3>
      <p><em>This section will be removed in a later version of this document.</em></p>
      <p>Additional Issues related to this document and not yet placed within it are listed at the:</p>
      <ul>
        <li><a href="https://github.com/w3c/dxwg/issues?utf8=%E2%9C%93&q=is%3Aissue+is%3Aopen+label%3Aprofile-negotiation+sort%3Acreated-asc+">GitHub Issues tracker for profile-negotiation</a></li>
      </ul>
    </section>
  </section>
  <script class="remove" src="config.js"></script>
  <script class="remove" src="https://www.w3.org/Tools/respec/respec-w3c-common"></script>
</body>
</html>
